# Ventoy Custom GRUB Menu
# Provides toram vs normal boot options for each OS
# Surface Pro 8 optimized

set timeout=10
set default=0

# ============================================================
# DEBIAN SURFACE
# ============================================================

menuentry "Debian Surface - Load to RAM (~823MB)" --class debian {
    set iso_path="/debian-surface-live.iso"
    loopback loop $vtoy_iso_part$iso_path
    linux (loop)/live/vmlinuz boot=live findiso=$iso_path toram quiet splash
    initrd (loop)/live/initrd.img
}

menuentry "Debian Surface - Normal Boot (keeps USB mounted)" --class debian {
    set iso_path="/debian-surface-live.iso"
    loopback loop $vtoy_iso_part$iso_path
    linux (loop)/live/vmlinuz boot=live findiso=$iso_path quiet splash
    initrd (loop)/live/initrd.img
}

# ============================================================
# NIXOS SURFACE SLIM
# ============================================================

menuentry "NixOS Surface - Load to RAM (~700MB)" --class nixos {
    set iso_path="/nixos-surface-slim.iso"
    loopback loop $vtoy_iso_part$iso_path
    linux (loop)/boot/bzImage init=/nix/store/*/init copytoram quiet
    initrd (loop)/boot/initrd
}

menuentry "NixOS Surface - Normal Boot (keeps USB mounted)" --class nixos {
    set iso_path="/nixos-surface-slim.iso"
    loopback loop $vtoy_iso_part$iso_path
    linux (loop)/boot/bzImage init=/nix/store/*/init quiet
    initrd (loop)/boot/initrd
}

# ============================================================
# UTILITIES
# ============================================================

menuentry "─────────────────────────────────" {
    true
}

menuentry "Boot from local disk" --class hdd {
    exit
}

menuentry "Reboot" --class reboot {
    reboot
}

menuentry "Shutdown" --class shutdown {
    halt
}
